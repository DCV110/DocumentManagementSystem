@{
    ViewData["Title"] = "Tài liệu của tôi - Teaching Staff Studio";
    Layout = "_SidebarLayout";
}

@using Microsoft.AspNetCore.Identity
@inject UserManager<ApplicationUser> UserManager

@{
    var currentUser = await UserManager.GetUserAsync(User);
    var isAdmin = false;
    if (currentUser != null)
    {
        var roles = await UserManager.GetRolesAsync(currentUser);
        isAdmin = roles.Contains("Admin");
    }
}

@if (isAdmin)
{
    <partial name="_AdminSidebar" />
}
else
{
    <partial name="_InstructorSidebar" />
}

<div class="main-content">
    <!-- Header -->
    <div class="content-header">
        <div class="header-title-section">
            <h1>Teaching Staff Studio</h1>
            <p>Quản lý và theo dõi hiệu suất tài liệu giảng dạy của bạn.</p>
        </div>
        <div class="header-actions">
            <button class="notification-icon">
                <span class="material-symbols-outlined">notifications</span>
                <span class="notification-dot"></span>
            </button>
        </div>
    </div>

    <!-- Content Body -->
    <div class="content-body">
        <!-- Summary Cards -->
        <div class="summary-cards">
            <!-- Total Views Card -->
            <div class="summary-card">
                <div class="summary-card-header">
                    <div>
                        <div class="summary-card-label">Tổng lượt xem</div>
                        <div class="summary-card-value">1,240</div>
                        <div class="summary-card-trend positive">
                            <span>↑</span>
                            <span>+12%</span>
                        </div>
                    </div>
                    <div class="summary-card-icon blue">
                        <span class="material-symbols-outlined">visibility</span>
                    </div>
                </div>
                <div class="summary-card-chart" style="background: linear-gradient(to top, #3b82f6 0%, transparent 100%);"></div>
            </div>

            <!-- Total Downloads Card -->
            <div class="summary-card">
                <div class="summary-card-header">
                    <div>
                        <div class="summary-card-label">Tổng lượt tải</div>
                        <div class="summary-card-value">850</div>
                        <div class="summary-card-trend positive">
                            <span>↑</span>
                            <span>+5%</span>
                        </div>
                    </div>
                    <div class="summary-card-icon green">
                        <span class="material-symbols-outlined">download</span>
                    </div>
                </div>
                <div class="summary-card-chart" style="background: linear-gradient(to top, #16a34a 0%, transparent 100%);"></div>
            </div>

            <!-- Pending Documents Card -->
            <div class="summary-card">
                <div class="summary-card-header">
                    <div>
                        <div class="summary-card-label">Tài liệu đang chờ duyệt</div>
                        <div class="summary-card-value">3</div>
                        <div class="summary-card-trend neutral">
                            <span>0%</span>
                        </div>
                    </div>
                    <div class="summary-card-icon yellow">
                        <span class="material-symbols-outlined">pending</span>
                    </div>
                </div>
                <button class="add-document-btn" style="background: #fbbf24; color: #78350f; margin-top: 16px; width: 100%;">
                    Cần xử lý sớm
                </button>
            </div>
        </div>

        <!-- Search and Filter Section -->
        <div class="search-filter-section">
            <div class="search-box-large">
                <span class="material-symbols-outlined search-icon-large">search</span>
                <input type="text" class="search-input-large" placeholder="Tìm kiếm theo tên tài liệu..." />
            </div>
            <div class="filter-buttons">
                <button class="filter-btn active">Tất cả</button>
                <button class="filter-btn">Đã đăng</button>
                <button class="filter-btn">Nháp</button>
            </div>
            <a href="@Url.Action("Upload", "Document")" class="add-document-btn" style="text-decoration: none;">
                <span class="material-symbols-outlined">add</span>
                <span>Thêm tài liệu mới</span>
            </a>
        </div>

        <!-- Documents Table -->
        <div class="documents-table-container">
            <table class="documents-table-modern">
                <thead>
                    <tr>
                        <th>Tên tài liệu</th>
                        <th>Ngày tạo</th>
                        <th>Lượt tải</th>
                        <th>Trạng thái</th>
                        <th>Hành động</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>
                            <div class="document-item">
                                <div class="document-item-icon red">
                                    <span class="material-symbols-outlined">picture_as_pdf</span>
                                </div>
                                <div class="document-item-info">
                                    <h5>Bài giảng Nhập môn CS101</h5>
                                    <p>Chương 1: Giới thiệu về Thuật toán</p>
                                </div>
                            </div>
                        </td>
                        <td style="color: #6b7280;">24 Tháng 10, 2023</td>
                        <td style="color: #111418; font-weight: 500;">142</td>
                        <td>
                            <span class="status-badge-modern green">
                                <span class="status-dot-modern green"></span>
                                Đã đăng
                            </span>
                        </td>
                        <td>
                            <button class="action-menu-btn" title="More options">
                                <span class="material-symbols-outlined">more_vert</span>
                            </button>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <div class="document-item">
                                <div class="document-item-icon blue">
                                    <span class="material-symbols-outlined">description</span>
                                </div>
                                <div class="document-item-info">
                                    <h5>Đề cương chi tiết Mạng máy tính</h5>
                                    <p>Học kỳ 1 - 2023/2024</p>
                                </div>
                            </div>
                        </td>
                        <td style="color: #6b7280;">22 Tháng 10, 2023</td>
                        <td style="color: #111418; font-weight: 500;">89</td>
                        <td>
                            <span class="status-badge-modern yellow">
                                <span class="status-dot-modern yellow"></span>
                                Chờ duyệt
                            </span>
                        </td>
                        <td>
                            <button class="action-menu-btn" title="More options">
                                <span class="material-symbols-outlined">more_vert</span>
                            </button>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <div class="document-item">
                                <div class="document-item-icon purple">
                                    <span class="material-symbols-outlined">slideshow</span>
                                </div>
                                <div class="document-item-info">
                                    <h5>Slide bài 4: Kiến trúc Web</h5>
                                    <p>Cập nhật lần cuối 2 giờ trước</p>
                                </div>
                            </div>
                        </td>
                        <td style="color: #6b7280;">Hôm nay</td>
                        <td style="color: #6b7280;">-</td>
                        <td>
                            <span class="status-badge-modern gray">
                                <span class="status-dot-modern gray"></span>
                                Nháp
                            </span>
                        </td>
                        <td>
                            <button class="action-menu-btn" title="More options">
                                <span class="material-symbols-outlined">more_vert</span>
                            </button>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <div class="document-item">
                                <div class="document-item-icon red">
                                    <span class="material-symbols-outlined">picture_as_pdf</span>
                                </div>
                                <div class="document-item-info">
                                    <h5>Bài tập lớn cuối kỳ</h5>
                                    <p>Yêu cầu và tiêu chí chấm điểm</p>
                                </div>
                            </div>
                        </td>
                        <td style="color: #6b7280;">20 Tháng 10, 2023</td>
                        <td style="color: #111418; font-weight: 500;">205</td>
                        <td>
                            <span class="status-badge-modern yellow">
                                <span class="status-dot-modern yellow"></span>
                                Chờ duyệt
                            </span>
                        </td>
                        <td>
                            <button class="action-menu-btn" title="More options">
                                <span class="material-symbols-outlined">more_vert</span>
                            </button>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <div class="document-item">
                                <div class="document-item-icon blue">
                                    <span class="material-symbols-outlined">description</span>
                                </div>
                                <div class="document-item-info">
                                    <h5>Danh sách nhóm Project</h5>
                                    <p>Cập nhật tiến độ tuần 5</p>
                                </div>
                            </div>
                        </td>
                        <td style="color: #6b7280;">18 Tháng 10, 2023</td>
                        <td style="color: #111418; font-weight: 500;">56</td>
                        <td>
                            <span class="status-badge-modern green">
                                <span class="status-dot-modern green"></span>
                                Đã đăng
                            </span>
                        </td>
                        <td>
                            <button class="action-menu-btn" title="More options">
                                <span class="material-symbols-outlined">more_vert</span>
                            </button>
                        </td>
                    </tr>
                </tbody>
            </table>
            <div class="table-footer">
                <div class="table-footer-info">
                    Hiển thị 1-5 trên 24 tài liệu
                </div>
                <div class="pagination-simple">
                    <button class="pagination-btn-simple" disabled>
                        <span class="material-symbols-outlined">chevron_left</span>
                    </button>
                    <button class="pagination-btn-simple">
                        <span class="material-symbols-outlined">chevron_right</span>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        // Theme toggle functionality
        document.querySelector('.theme-toggle')?.addEventListener('click', function() {
            document.body.classList.toggle('dark-theme');
        });

        // Filter buttons
        document.querySelectorAll('.filter-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
                this.classList.add('active');
            });
        });
    </script>
}

